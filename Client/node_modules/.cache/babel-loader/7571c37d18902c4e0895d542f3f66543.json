{"ast":null,"code":"import _classCallCheck from \"G:\\\\WORKSPACE\\\\Project\\\\Besocial\\\\Besocial\\\\Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"G:\\\\WORKSPACE\\\\Project\\\\Besocial\\\\Besocial\\\\Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"G:\\\\WORKSPACE\\\\Project\\\\Besocial\\\\Besocial\\\\Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"G:\\\\WORKSPACE\\\\Project\\\\Besocial\\\\Besocial\\\\Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"G:\\\\WORKSPACE\\\\Project\\\\Besocial\\\\Besocial\\\\Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"G:\\\\WORKSPACE\\\\Project\\\\Besocial\\\\Besocial\\\\Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nimport _taggedTemplateLiteral from \"G:\\\\WORKSPACE\\\\Project\\\\Besocial\\\\Besocial\\\\Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"G:\\\\WORKSPACE\\\\Project\\\\Besocial\\\\Besocial\\\\Client\\\\src\\\\components\\\\user\\\\UserGalleryPage.js\";\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n        display: block;\\n        margin: 0 auto;\\n        border-color: red;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { Component, Fragment } from 'react';\nimport { userService } from '../../infrastructure';\nimport { toast } from 'react-toastify';\nimport { ToastComponent } from '../common';\nimport Picture from './Picture';\nimport './css/UserGallery.css';\nimport { css } from '@emotion/core';\nimport { RingLoader, GridLoader, MoonLoader, CircleLoader } from 'react-spinners';\nimport { connect } from 'react-redux';\nimport { changeCurrentTimeLineUserAction, changeAllFriendsAction } from '../../store/actions/userActions';\nimport { addPicturesAction, changeAllPicturesAction, removePictureAction } from '../../store/actions/pictureActions';\nvar override = css(_templateObject());\n\nvar UserGalleryPage =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(UserGalleryPage, _Component);\n\n  function UserGalleryPage(props) {\n    var _this;\n\n    _classCallCheck(this, UserGalleryPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(UserGalleryPage).call(this, props));\n\n    _this.uploadFile = function () {\n      _this.setState({\n        error: '',\n        msg: ''\n      });\n\n      if (!_this.state.file) {\n        toast.error(React.createElement(ToastComponent.errorToast, {\n          text: \"Please upload a file.\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 91\n          },\n          __self: this\n        }), {\n          position: toast.POSITION.TOP_RIGHT\n        });\n        return;\n      }\n\n      if (_this.state.file.size >= 2000000) {\n        toast.error(React.createElement(ToastComponent.errorToast, {\n          text: \"File size exceeds limit of 2MB.\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 98\n          },\n          __self: this\n        }), {\n          position: toast.POSITION.TOP_RIGHT\n        });\n        return;\n      }\n\n      var timeLineUserId = _this.props.timeLineUserData.id;\n      var data = new FormData();\n      data.append('file', _this.state.file);\n      data.append('loggedInUserId', timeLineUserId);\n\n      _this.props.addImage(data, timeLineUserId);\n    };\n\n    _this.removePhoto = function (photoToRemoveId) {\n      var timeLineUserId = _this.props.timeLineUserData.id;\n      var loggedInUserId = _this.props.loggedInUserData.id;\n\n      _this.props.removeImage(loggedInUserId, photoToRemoveId, timeLineUserId);\n    };\n\n    _this.onFileChange = function (event) {\n      _this.setState({\n        file: event.target.files[0],\n        ready: false\n      }, function () {\n        return _this.uploadFile();\n      });\n    };\n\n    _this.state = {\n      file: '',\n      error: '',\n      msg: '',\n      ready: true\n    };\n    _this.uploadFile = _this.uploadFile.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onFileChange = _this.onFileChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.removePhoto = _this.removePhoto.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(UserGalleryPage, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var currentTimeLineUserId = this.props.match.params.id;\n\n      if (currentTimeLineUserId !== this.props.timeLineUserData.id) {\n        this.props.changeTimeLineUser(currentTimeLineUserId);\n        this.props.changeAllPictures(currentTimeLineUserId);\n        this.props.changeAllFriends(currentTimeLineUserId);\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      var loading = this.props.addPicture.loading;\n\n      if (!loading && this.props.addPicture !== prevProps.addPicture) {\n        this.setState({\n          ready: true\n        });\n      }\n\n      var errorMessage = this.getErrorMessage(prevProps);\n      var successMessage = this.getSuccessMessage(prevProps);\n\n      if (errorMessage) {\n        toast.error(React.createElement(ToastComponent.errorToast, {\n          text: errorMessage,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 57\n          },\n          __self: this\n        }), {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      } else if (successMessage) {\n        toast.success(React.createElement(ToastComponent.successToast, {\n          text: successMessage,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 61\n          },\n          __self: this\n        }), {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      }\n    }\n  }, {\n    key: \"getSuccessMessage\",\n    value: function getSuccessMessage(prevProps) {\n      if (!this.props.addPicture.hasError && this.props.addPicture.message && this.props.addPicture !== prevProps.addPicture) {\n        return this.props.addPicture.message;\n      } else if (!this.props.removePicture.hasError && this.props.removePicture.message && this.props.removePicture !== prevProps.removePicture) {\n        return this.props.removePicture.message;\n      }\n\n      return null;\n    }\n  }, {\n    key: \"getErrorMessage\",\n    value: function getErrorMessage(prevProps) {\n      if (this.props.addPicture.hasError && prevProps.addPicture.error !== this.props.addPicture.error) {\n        return this.props.addPicture.message || 'Server Error';\n      } else if (this.props.removePicture.hasError && prevProps.removePicture.error !== this.props.removePicture.error) {\n        return this.props.removePicture.message || 'Server Error';\n      }\n\n      return null;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      if (!this.state.ready && this.props.picturesArr.length === 0) {// return <CircleLoader\n        //     css={override}\n        //     sizeUnit={\"px\"}\n        //     size={150}\n        //     color={'#61dafb'}\n        //     loading={true}\n        // />\n      }\n\n      var isRoot = userService.isRoot();\n      var isTheCurrentLoggedInUser = this.props.loggedInUserData.id === this.props.timeLineUserData.id;\n      var formattedUserNames = userService.formatUsername(this.props.timeLineUserData.firstName, this.props.timeLineUserData.lastName);\n      return React.createElement(\"section\", {\n        className: \"galerry-section\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, React.createElement(\"article\", {\n        className: \"aside-article-photos\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"gallery-article-intro\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"gallery-aside-article-header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"aside-article-icon\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"fas fa-images\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      })), React.createElement(\"h3\", {\n        className: \"aside-article-title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, \"Photos\")), (isRoot || isTheCurrentLoggedInUser) && React.createElement(\"div\", {\n        className: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"button update-info\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        className: \"cursor-pointer\",\n        id: \"upload\",\n        htmlFor: \"fileUpload\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, \" ADD PHOTO\", React.createElement(\"input\", {\n        className: \"cursor-pointer\",\n        id: \"fileUpload\",\n        onChange: this.onFileChange,\n        type: \"file\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }))))), this.props.picturesArr.length > 0 ? React.createElement(Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"hr-styles\",\n        style: {\n          'width': '90%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170\n        },\n        __self: this\n      }), !this.state.ready ? React.createElement(CircleLoader, {\n        css: override,\n        sizeUnit: \"px\",\n        size: 150,\n        color: '#61dafb',\n        loading: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }) : React.createElement(\"ul\", {\n        className: \"grid-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, this.props.picturesArr.map(function (picture) {\n        return React.createElement(Picture, Object.assign({\n          key: picture.id,\n          removePhoto: _this2.removePhoto\n        }, picture, {\n          userId: _this2.props.timeLineUserData.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 181\n          },\n          __self: this\n        }));\n      }))) : React.createElement(Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, !this.state.ready ? React.createElement(Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"hr-styles\",\n        style: {\n          'width': '90%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }), React.createElement(CircleLoader, {\n        css: override,\n        sizeUnit: \"px\",\n        size: 150,\n        color: '#61dafb',\n        loading: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      })) : React.createElement(Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"hr-styles\",\n        style: {\n          'width': '90%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }), React.createElement(\"h3\", {\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, \"There are no photos of \", React.createElement(\"span\", {\n        className: \"username-gallery\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, \"\".concat(formattedUserNames)), \" !\"), React.createElement(\"div\", {\n        className: \"hr-styles\",\n        style: {\n          'width': '90%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      })))));\n    }\n  }]);\n\n  return UserGalleryPage;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    addPicture: state.addPicture,\n    removePicture: state.removePicture,\n    picturesArr: state.fetchPictures.picturesArr,\n    fetchPictures: state.fetchPictures,\n    timeLineUserData: state.timeLineUserData,\n    loggedInUserData: state.loggedInUserData\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    changeTimeLineUser: function changeTimeLineUser(userId) {\n      dispatch(changeCurrentTimeLineUserAction(userId));\n    },\n    changeAllFriends: function changeAllFriends(userId) {\n      dispatch(changeAllFriendsAction(userId));\n    },\n    changeAllPictures: function changeAllPictures(userId) {\n      dispatch(changeAllPicturesAction(userId));\n    },\n    addImage: function addImage(data, userId) {\n      dispatch(addPicturesAction(data, userId));\n    },\n    removeImage: function removeImage(loggedInUserId, photoToRemoveId, timeLineUserId) {\n      dispatch(removePictureAction(loggedInUserId, photoToRemoveId, timeLineUserId));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UserGalleryPage);","map":{"version":3,"sources":["G:\\WORKSPACE\\Project\\Besocial\\Besocial\\Client\\src\\components\\user\\UserGalleryPage.js"],"names":["React","Component","Fragment","userService","toast","ToastComponent","Picture","css","RingLoader","GridLoader","MoonLoader","CircleLoader","connect","changeCurrentTimeLineUserAction","changeAllFriendsAction","addPicturesAction","changeAllPicturesAction","removePictureAction","override","UserGalleryPage","props","uploadFile","setState","error","msg","state","file","position","POSITION","TOP_RIGHT","size","timeLineUserId","timeLineUserData","id","data","FormData","append","addImage","removePhoto","photoToRemoveId","loggedInUserId","loggedInUserData","removeImage","onFileChange","event","target","files","ready","bind","currentTimeLineUserId","match","params","changeTimeLineUser","changeAllPictures","changeAllFriends","prevProps","prevState","loading","addPicture","errorMessage","getErrorMessage","successMessage","getSuccessMessage","success","hasError","message","removePicture","picturesArr","length","isRoot","isTheCurrentLoggedInUser","formattedUserNames","formatUsername","firstName","lastName","map","picture","mapStateToProps","fetchPictures","mapDispatchToProps","dispatch","userId"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from 'react';\nimport { userService } from '../../infrastructure'\nimport { toast } from 'react-toastify';\nimport { ToastComponent } from '../common'\nimport Picture from './Picture';\nimport './css/UserGallery.css';\n\nimport { css } from '@emotion/core';\nimport { RingLoader, GridLoader, MoonLoader, CircleLoader } from 'react-spinners';\n\nimport { connect } from 'react-redux';\nimport { changeCurrentTimeLineUserAction, changeAllFriendsAction } from '../../store/actions/userActions';\nimport { addPicturesAction, changeAllPicturesAction, removePictureAction } from '../../store/actions/pictureActions';\n\nconst override = css`\n        display: block;\n        margin: 0 auto;\n        border-color: red;\n`;\n\nclass UserGalleryPage extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            file: '',\n            error: '',\n            msg: '',\n            ready: true,\n        };\n\n        this.uploadFile = this.uploadFile.bind(this);\n        this.onFileChange = this.onFileChange.bind(this);\n        this.removePhoto = this.removePhoto.bind(this);\n    }\n\n    componentDidMount() {\n        const currentTimeLineUserId = this.props.match.params.id;\n        if (currentTimeLineUserId !== this.props.timeLineUserData.id) {\n            this.props.changeTimeLineUser(currentTimeLineUserId);\n            this.props.changeAllPictures(currentTimeLineUserId);\n            this.props.changeAllFriends(currentTimeLineUserId);\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        const loading = this.props.addPicture.loading\n\n        if (!loading && this.props.addPicture !== prevProps.addPicture) {\n            this.setState({ ready: true })\n        }\n\n        const errorMessage = this.getErrorMessage(prevProps);\n        const successMessage = this.getSuccessMessage(prevProps)\n\n        if (errorMessage) {\n            toast.error(<ToastComponent.errorToast text={errorMessage} />, {\n                position: toast.POSITION.TOP_RIGHT\n            });\n        } else if (successMessage) {\n            toast.success(<ToastComponent.successToast text={successMessage} />, {\n                position: toast.POSITION.TOP_RIGHT\n            });\n        }\n    }\n\n    getSuccessMessage(prevProps) {\n        if (!this.props.addPicture.hasError && this.props.addPicture.message && this.props.addPicture !== prevProps.addPicture) {\n            return this.props.addPicture.message;\n        } else if (!this.props.removePicture.hasError && this.props.removePicture.message && this.props.removePicture !== prevProps.removePicture) {\n            return this.props.removePicture.message;\n        }\n\n        return null;\n    }\n\n    getErrorMessage(prevProps) {\n        if (this.props.addPicture.hasError && prevProps.addPicture.error !== this.props.addPicture.error) {\n            return this.props.addPicture.message || 'Server Error';\n        } else if (this.props.removePicture.hasError && prevProps.removePicture.error !== this.props.removePicture.error) {\n            return this.props.removePicture.message || 'Server Error';\n        }\n\n        return null;\n    }\n\n    uploadFile = () => {\n        this.setState({ error: '', msg: '' });\n\n        if (!this.state.file) {\n            toast.error(<ToastComponent.errorToast text='Please upload a file.' />, {\n                position: toast.POSITION.TOP_RIGHT\n            });\n            return;\n        }\n\n        if (this.state.file.size >= 2000000) {\n            toast.error(<ToastComponent.errorToast text='File size exceeds limit of 2MB.' />, {\n                position: toast.POSITION.TOP_RIGHT\n            });\n            return;\n        }\n\n        const timeLineUserId = this.props.timeLineUserData.id;\n\n        let data = new FormData();\n        data.append('file', this.state.file);\n        data.append('loggedInUserId', timeLineUserId);\n\n        this.props.addImage(data, timeLineUserId);\n    }\n\n    removePhoto = (photoToRemoveId) => {\n        const timeLineUserId = this.props.timeLineUserData.id;\n        const loggedInUserId = this.props.loggedInUserData.id;\n\n        this.props.removeImage(loggedInUserId, photoToRemoveId, timeLineUserId);\n    }\n\n    onFileChange = (event) => {\n        this.setState({\n            file: event.target.files[0],\n            ready: false\n        }, () => this.uploadFile());\n    }\n\n    render() {\n        if (!this.state.ready && this.props.picturesArr.length === 0) {\n            // return <CircleLoader\n            //     css={override}\n            //     sizeUnit={\"px\"}\n            //     size={150}\n            //     color={'#61dafb'}\n            //     loading={true}\n            // />\n        }\n\n        const isRoot = userService.isRoot();\n        const isTheCurrentLoggedInUser = (this.props.loggedInUserData.id === this.props.timeLineUserData.id);\n\n        const formattedUserNames = userService.formatUsername(this.props.timeLineUserData.firstName, this.props.timeLineUserData.lastName)\n\n        return (\n\n            <section className=\"galerry-section\">\n\n                <article className=\"aside-article-photos\">\n                    <div className=\"gallery-article-intro\">\n\n                        <div className=\"gallery-aside-article-header\"  >\n                            <div className=\"aside-article-icon\">\n                                <i className=\"fas fa-images\"></i>\n                            </div>\n                            <h3 className=\"aside-article-title\">Photos</h3>\n                        </div>\n\n                        {(isRoot || isTheCurrentLoggedInUser) && <div className=\"\">\n                            <button className=\"button update-info\">\n                                <label className=\"cursor-pointer\" id=\"upload\" htmlFor=\"fileUpload\" > ADD PHOTO\n                                <input className=\"cursor-pointer\" id=\"fileUpload\" onChange={this.onFileChange} type=\"file\" />\n                                </label>\n                            </button>\n                        </div>}\n\n                    </div>\n\n                    {this.props.picturesArr.length > 0\n                        ?\n                        <Fragment>\n                            <div className=\"hr-styles\" style={{ 'width': '90%' }}></div>\n\n                            {!this.state.ready ?\n                                <CircleLoader\n                                    css={override}\n                                    sizeUnit={\"px\"}\n                                    size={150}\n                                    color={'#61dafb'}\n                                    loading={true}\n                                /> :\n                                <ul className=\"grid-container\">\n                                    {this.props.picturesArr.map((picture) => <Picture key={picture.id} removePhoto={this.removePhoto}  {...picture} userId={this.props.timeLineUserData.id} />)}\n                                </ul>}\n                        </Fragment>\n                        :\n\n                        <Fragment>\n                            {!this.state.ready ?\n                                <Fragment>\n                                    <div className=\"hr-styles\" style={{ 'width': '90%' }}></div>\n                                    <CircleLoader\n                                        css={override}\n                                        sizeUnit={\"px\"}\n                                        size={150}\n                                        color={'#61dafb'}\n                                        loading={true}\n                                    />\n                                </Fragment> :\n                                <Fragment>\n                                    <div className=\"hr-styles\" style={{ 'width': '90%' }}></div>\n                                    <h3 className=\"text-center\">There are no photos of <span className=\"username-gallery\">{`${formattedUserNames}`}</span> !</h3>\n                                    <div className=\"hr-styles\" style={{ 'width': '90%' }}></div>\n                                </Fragment>\n                            }\n                        </Fragment>\n                    }\n                </article>\n            </section>\n        )\n    }\n}\n\nconst mapStateToProps = (state) => {\n    return {\n        addPicture: state.addPicture,\n        removePicture: state.removePicture,\n        picturesArr: state.fetchPictures.picturesArr,\n        fetchPictures: state.fetchPictures,\n        timeLineUserData: state.timeLineUserData,\n        loggedInUserData: state.loggedInUserData,\n    }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n    return {\n        changeTimeLineUser: (userId) => { dispatch(changeCurrentTimeLineUserAction(userId)) },\n        changeAllFriends: (userId) => { dispatch(changeAllFriendsAction(userId)) },\n        changeAllPictures: (userId) => { dispatch(changeAllPicturesAction(userId)) },\n        addImage: (data, userId) => { dispatch(addPicturesAction(data, userId)) },\n        removeImage: (loggedInUserId, photoToRemoveId, timeLineUserId) => { dispatch(removePictureAction(loggedInUserId, photoToRemoveId, timeLineUserId)) },\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UserGalleryPage);"]},"metadata":{},"sourceType":"module"}